name: Slack Notifier

on:
  issues:
    types: [opened, closed]
  issue_comment:
    types: [created]
  pull_request:
    types: [opened, closed]
  pull_request_review:
    types: [submitted]
  pull_request_review_comment:
    types: [created]
  push:
  create:
    branches:
  delete:
    branches:

jobs:
  notify:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Set env vars
        env:
          EVENT_NAME: ${{ github.event_name }}
          ACTION: ${{ github.event.action }}
        run: |
          echo "EVENT_NAME=${EVENT_NAME}" >> $GITHUB_ENV
          echo "ACTION=${ACTION}" >> $GITHUB_ENV

      # ‚úÖ Ïù¥Ïäà ÏÉùÏÑ±
      - name: Notify Issue Opened
        if: env.EVENT_NAME == 'issues' && env.ACTION == 'opened'
        env:
          SLACK_WEBHOOK_URL: ${{ secrets.SLACK_WEBHOOK_URL }}
        run: bash scripts/slack/issue_opened.sh

      # ‚úÖ Ïù¥Ïäà Ï¢ÖÎ£å
      - name: Notify Issue Closed
        if: env.EVENT_NAME == 'issues' && env.ACTION == 'closed'
        env:
          SLACK_WEBHOOK_URL: ${{ secrets.SLACK_WEBHOOK_URL }}
        run: bash scripts/slack/issue_closed.sh

      # ‚úÖ Ïù¥Ïäà ÏΩîÎ©òÌä∏
      - name: Notify Issue Commented
        if: env.EVENT_NAME == 'issue_comment' && env.ACTION == 'created' && github.event.issue.pull_request == null
        env:
          SLACK_WEBHOOK_URL: ${{ secrets.SLACK_WEBHOOK_URL }}
        run: bash scripts/slack/issue_commented.sh

      # ‚úÖ PR ÏÉùÏÑ±
      - name: Notify PR Opened
        if: env.EVENT_NAME == 'pull_request' && env.ACTION == 'opened'
        env:
          SLACK_WEBHOOK_URL: ${{ secrets.SLACK_WEBHOOK_URL }}
        run: bash scripts/slack/pr_opened.sh

      # ‚úÖ PR Î≥ëÌï©
      - name: Notify PR Merged
        if: env.EVENT_NAME == 'pull_request' && env.ACTION == 'closed' && github.event.pull_request.merged == true
        env:
          SLACK_WEBHOOK_URL: ${{ secrets.SLACK_WEBHOOK_URL }}
        run: bash scripts/slack/pr_merged.sh

      # ‚úÖ PR Í∞ïÏ†ú Ï¢ÖÎ£å
      - name: Notify PR Force Closed
        if: env.EVENT_NAME == 'pull_request' && env.ACTION == 'closed' && github.event.pull_request.merged == false
        env:
          SLACK_WEBHOOK_URL: ${{ secrets.SLACK_WEBHOOK_URL }}
        run: bash scripts/slack/pr_force_closed.sh

      # ‚úÖ PR Î¶¨Î∑∞ ÏäπÏù∏
      - name: Notify PR Review Submitted - Approved
        if: env.EVENT_NAME == 'pull_request_review' && env.ACTION == 'submitted' && github.event.review.state == 'approved'
        env:
          SLACK_WEBHOOK_URL: ${{ secrets.SLACK_WEBHOOK_URL }}
          REVIEW_HEADER: "‚úÖ PR Î¶¨Î∑∞ ÏäπÏù∏"
        run: bash scripts/slack/pr_review_submitted.sh

      # ‚úÖ PR Î¶¨Î∑∞ Î≥ÄÍ≤Ω ÏöîÏ≤≠
      - name: Notify PR Review Submitted - Changes Requested
        if: env.EVENT_NAME == 'pull_request_review' && env.ACTION == 'submitted' && github.event.review.state == 'changes_requested'
        env:
          SLACK_WEBHOOK_URL: ${{ secrets.SLACK_WEBHOOK_URL }}
          REVIEW_HEADER: "‚ùó PR Î¶¨Î∑∞ Î≥ÄÍ≤Ω ÏöîÏ≤≠"
        run: bash scripts/slack/pr_review_submitted.sh

      # ‚úÖ PR Î¶¨Î∑∞ ÏΩîÎ©òÌä∏
      - name: Notify PR Review Submitted - Commented
        if: env.EVENT_NAME == 'pull_request_review' && env.ACTION == 'submitted' && github.event.review.state == 'commented'
        env:
          SLACK_WEBHOOK_URL: ${{ secrets.SLACK_WEBHOOK_URL }}
          REVIEW_HEADER: "üí¨ PR Î¶¨Î∑∞ ÏΩîÎ©òÌä∏"
        run: bash scripts/slack/pr_review_submitted.sh

      # ‚úÖ PR ÎùºÏù∏ ÏΩîÎ©òÌä∏
      - name: Notify PR Line Commented
        if: env.EVENT_NAME == 'pull_request_review_comment' && env.ACTION == 'created'
        env:
          SLACK_WEBHOOK_URL: ${{ secrets.SLACK_WEBHOOK_URL }}
        run: bash scripts/slack/pr_line_commented.sh

      # ‚úÖ PR ÏΩîÎ©òÌä∏
      - name: Notify PR General Commented
        if: env.EVENT_NAME == 'issue_comment' && env.ACTION == 'created' && github.event.issue.pull_request != null
        env:
          SLACK_WEBHOOK_URL: ${{ secrets.SLACK_WEBHOOK_URL }}
        run: bash scripts/slack/pr_commented.sh

      # ‚úÖ Î∏åÎûúÏπò ÏÉùÏÑ±
      - name: Notify Branch Created
        if: github.event.ref_type == 'branch'
        env:
          SLACK_WEBHOOK_URL: ${{ secrets.SLACK_WEBHOOK_URL }}
        run: bash scripts/slack/branch_created.sh

      # ‚úÖ Î∏åÎûúÏπò ÏÇ≠Ï†ú
      - name: Notify Branch Deleted
        if: github.event.ref_type == 'branch'
        env:
          SLACK_WEBHOOK_URL: ${{ secrets.SLACK_WEBHOOK_URL }}
        run: bash scripts/slack/branch_deleted.sh

      # ‚úÖ Ïª§Î∞ã Ìë∏Ïãú
      - name: Notify Push Commits
        if: env.EVENT_NAME == 'push' && startsWith(github.ref, 'refs/heads/')
        env:
          SLACK_WEBHOOK_URL: ${{ secrets.SLACK_WEBHOOK_URL }}
        run: bash scripts/slack/push_committed.sh
